<h2>SpiritBridge Chat</h2>
<div id="chatBox" style="height:300px;overflow-y:scroll;border:1px solid #ccc;padding:10px;"></div>
<input type="text" id="messageInput" placeholder="Type a message..." />
<button onclick="sendMessage()">Send</button>

<script>
const CHAT_ENDPOINT = 'YOUR_SPIRITBRIDGE_CHAT_ENDPOINT'; // SpiritBridge collection for chat
const API_KEY = 'YOUR_SPIRITBRIDGE_API_KEY';

async function sendMessage() {
    const msg = document.getElementById('messageInput').value;
    if(!msg) return alert('Type a message!');

    await fetch(CHAT_ENDPOINT, {
        method: 'POST',
        headers: {
            'Content-Type':'application/json',
            'Authorization': 'Bearer ' + API_KEY
        },
        body: JSON.stringify({message: msg, timestamp: new Date().toISOString()})
    });

    document.getElementById('messageInput').value = '';
    loadMessages();
}

async function loadMessages() {
    const res = await fetch(CHAT_ENDPOINT, {
        headers: {'Authorization': 'Bearer ' + API_KEY}
    });
    const data = await res.json();
    const chatBox = document.getElementById('chatBox');
    chatBox.innerHTML = '';
    data.forEach(item => {
        const div = document.createElement('div');
        div.textContent = `[${new Date(item.timestamp).toLocaleTimeString()}] ${item.message}`;
        chatBox.appendChild(div);
    });
}

// auto refresh every 3 seconds
setInterval(loadMessages, 3000);
loadMessages();
</script>
